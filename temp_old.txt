<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medieval Trading Game</title>
    <!-- üñ§ CSS Variables (must load first) -->
    <link rel="stylesheet" href="src/css/base/variables.css?v=0.88">
    <!-- Main stylesheets üñ§ -->
    <link rel="stylesheet" href="src/css/styles.css?v=0.88">
    <link rel="stylesheet" href="src/css/ui-enhancements.css?v=0.88">
    <link rel="stylesheet" href="src/css/npc-systems.css?v=0.88">
    <!-- üñ§ Z-Index System - MUST be last to override everything -->
    <link rel="stylesheet" href="src/css/z-index-system.css?v=0.88">
    <!-- ‚öôÔ∏è CONFIG MUST LOAD FIRST - All other scripts depend on it -->
    <script src="config.js?v=0.88"></script>
    <script>
        // Update document title from config immediately
        if (typeof GameConfig !== 'undefined') {
            document.title = GameConfig.game.name;
        }
    </script>
</head>
<body>
    <!-- Overlay Container for all modals and overlays -->
    <div id="overlay-container">
        <!-- World Map Overlay -->
        <div id="world-map-overlay" class="overlay">
            <div class="overlay-content">
                <button class="overlay-close" data-close-overlay="world-map-overlay" title="Close">√ó</button>
                <div class="map-container">
                    <!-- HTML-based map container - GameWorldRenderer renders here -->
                    <div id="world-map-overlay-html" class="html-map-container"></div>
                    <div class="map-controls">
                        <button id="overlay-zoom-in-btn" title="Zoom In">+</button>
                        <button id="overlay-zoom-out-btn" title="Zoom Out">-</button>
                        <button id="overlay-reset-view-btn" title="Reset View">‚ü≤</button>
                        <button id="overlay-toggle-grid-btn" title="Toggle Grid">‚äû</button>
                        <button id="overlay-center-player-btn" title="Center on Player">üéØ</button>
                    </div>
                </div>
                <div id="overlay-location-details" class="location-details-panel hidden">
                    <!-- ‚ú® JS fills this with location info -->
                </div>
            </div>
        </div>

        <!-- ‚öôÔ∏è Settings Panel is now dynamically created by settings-panel.js -->
        <!-- The unified SettingsPanel handles all settings with proper z-index -->

        <!-- üë§ Character Creation Overlay - define your tragic protagonist -->
        <div id="character-creation-overlay" class="overlay">
            <div class="overlay-content">
                <button class="overlay-close" data-close-overlay="character-creation-overlay" title="Close character creation">√ó</button>
                <h2>Create Your Character</h2>
                <div id="character-creation-content">
                    <!-- Character creation will be populated here -->
                </div>
            </div>
        </div>

        <!-- Market Overlay -->
        <div id="market-overlay" class="overlay">
            <div class="overlay-content">
                <button class="overlay-close" data-close-overlay="market-overlay" title="Close market">√ó</button>
                <h2>Market</h2>
                <div id="market-overlay-content">
                    <!-- Market content will be populated here -->
                </div>
            </div>
        </div>

        <!-- Inventory Overlay -->
        <div id="inventory-overlay" class="overlay">
            <div class="overlay-content">
                <button class="overlay-close" data-close-overlay="inventory-overlay" title="Close inventory">√ó</button>
                <h2>Inventory</h2>
                <div id="inventory-overlay-content">
                    <!-- Inventory content will be populated here -->
                </div>
            </div>
        </div>

        <!-- üö∂ Travel Progress Overlay - the journey (and the suffering) -->
        <div id="travel-progress-overlay" class="overlay">
            <div class="overlay-content">
                <h2>Travel Progress</h2>
                <div class="travel-progress">
                    <h3 id="travel-destination">Traveling to...</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="travel-progress-fill"></div>
                    </div>
                    <p>Distance: <span id="travel-distance">0</span> / <span id="travel-total-distance">0</span> miles</p>
                    <p>Time Remaining: <span id="travel-time-remaining">0</span> hours</p>
                    <p>Stats Drained:</p>
                    <div class="stat-drain">
                        <p>Hunger: <span id="hunger-drain">0</span></p>
                        <p>Thirst: <span id="thirst-drain">0</span></p>
                        <p>Fatigue: <span id="fatigue-drain">0</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- üé≤ Random Encounter Overlay - plot twists incoming -->
        <div id="random-encounter-overlay" class="overlay">
            <div class="overlay-content">
                <h2>Random Encounter</h2>
                <div class="encounter-content">
                    <h3 id="encounter-title">Encounter Title</h3>
                    <p id="encounter-description">Encounter description</p>
                    <div class="encounter-choices" id="encounter-choices">
                        <!-- Encounter choices will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- üèÜ Achievement Panel - flex your accomplishments -->
        <div id="achievement-overlay" class="achievement-overlay" onclick="if(event.target === this) closeAchievementPanel()">
            <div class="achievement-panel" onclick="event.stopPropagation()">
                <button class="panel-close-x" onclick="closeAchievementPanel(); event.stopPropagation();" title="Close">√ó</button>
                <div class="achievement-panel-header">
                    <div>
                        <h2 class="achievement-panel-title">üèÜ Achievements</h2>
                        <div class="achievement-progress">
                            <span id="achievement-progress-text">0 / 0 (0%)</span>
                            <div class="achievement-progress-bar">
                                <div id="achievement-progress-fill" class="achievement-progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="achievement-categories">
                    <button class="achievement-category-btn active" data-category="all" onclick="filterAchievements(this, 'all')" title="Show all achievements">All</button>
                    <button class="achievement-category-btn" data-category="wealth" onclick="filterAchievements(this, 'wealth')" title="Show wealth-related achievements">üí∞ Wealth</button>
                    <button class="achievement-category-btn" data-category="trading" onclick="filterAchievements(this, 'trading')" title="Show trading-related achievements">ü§ù Trading</button>
                    <button class="achievement-category-btn" data-category="travel" onclick="filterAchievements(this, 'travel')" title="Show travel-related achievements">üó∫Ô∏è Travel</button>
                    <button class="achievement-category-btn" data-category="survival" onclick="filterAchievements(this, 'survival')" title="Show survival-related achievements">üõ°Ô∏è Survival</button>
                    <button class="achievement-category-btn" data-category="collection" onclick="filterAchievements(this, 'collection')" title="Show collection-related achievements">üéí Collection</button>
                    <button class="achievement-category-btn" data-category="time" onclick="filterAchievements(this, 'time')" title="Show time-based achievements">‚è∞ Time</button>
                    <button class="achievement-category-btn" data-category="special" onclick="filterAchievements(this, 'special')" title="Show special achievements">‚ú® Special</button>
                    <button class="achievement-category-btn leaderboard-btn" onclick="showLeaderboardPanel()" title="View global leaderboard">üèÜ Hall of Champions</button>
                </div>

                <div id="achievement-grid" class="achievement-grid">
                    <!-- Achievements will be populated by JavaScript -->
                </div>

                <div class="panel-footer">
                    <button class="panel-close-btn-footer" onclick="closeAchievementPanel(); event.stopPropagation();" title="Close achievement panel">Close</button>
                </div>
            </div>
        </div>

        <!-- üíÄ Game Over Screen - the final curtain -->
        <div id="game-over-overlay" class="game-over-overlay hidden">
            <div class="game-over-panel">
                <div class="game-over-header">
                    <h1 id="game-over-title">üíÄ GAME OVER üíÄ</h1>
                    <p id="game-over-cause" class="game-over-cause">your journey ends here...</p>
                </div>
                <div class="game-over-stats">
                    <h3>üìä Final Reckoning</h3>
                    <div class="stats-grid" id="game-over-stats-grid">
                        <!-- Stats populated by JavaScript -->
                    </div>
                </div>
                <div class="game-over-ranking" id="game-over-ranking">
                    <!-- Ranking info populated by JavaScript -->
                </div>
                <div class="game-over-actions">
                    <button class="game-over-btn primary" onclick="closeGameOverAndRestart()" title="Start a new game">üîÑ Try Again</button>
                    <button class="game-over-btn" onclick="closeGameOverToMenu()" title="Return to main menu">üè† Main Menu</button>
                    <button class="game-over-btn" onclick="showLeaderboardFromGameOver()" title="View the Hall of Champions">üèÜ View Leaderboard</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ú® Perk Selection Modal - OUTSIDE overlay-container so it works during game setup -->
    <div id="perk-selection-modal" class="overlay">
        <div class="overlay-content perk-modal-content">
            <div class="perk-modal-header">
                <h2>‚ö° Choose Your Perks</h2>
                <button class="overlay-close" onclick="closePerkModal()" title="Close perk selection">√ó</button>
            </div>
            <div class="perk-modal-body">
                <div class="perk-modal-info">
                    <p>Select up to 2 perks that will shape your character's journey. Each perk provides unique bonuses and penalties.</p>
                    <div class="perk-selection-counter">
                        <span class="counter-label">Selected:</span>
                        <span class="counter-value"><span id="modal-selected-count">0</span> / 2</span>
                    </div>
                </div>
                <div id="perks-container" class="perks-modal-grid">
                    <!-- Perks will be populated by JavaScript -->
                </div>
            </div>
            <div class="perk-modal-footer">
                <button type="button" class="btn-secondary" onclick="closePerkModal()" title="Cancel perk selection">Cancel</button>
                <button type="button" id="confirm-perk-btn" class="btn-primary" onclick="confirmPerkSelection()" title="Confirm your perk choices">Confirm Selection</button>
            </div>
        </div>
    </div>

    <div id="game-container" class="hidden">
        <!-- üñ§ TOP BAR - Time controls, title, and info widgets -->
        <div id="top-bar">
            <div class="time-controls-top">
                <button id="pause-btn" class="time-btn active" title="Pause game time">‚è∏Ô∏è</button>
                <button id="normal-speed-btn" class="time-btn" title="Set time to normal speed (1x)">‚ñ∂Ô∏è</button>
                <button id="fast-speed-btn" class="time-btn" title="Set time to fast speed (2x)">‚è©</button>
                <button id="very-fast-speed-btn" class="time-btn" title="Set time to very fast speed (3x)">‚è≠Ô∏è</button>
            </div>
            <div class="top-bar-title" id="top-bar-title">Medieval Trading Game</div>
            <div class="top-bar-widgets" id="top-bar-widgets">
                <!-- Date and weather indicators will be added here by JS -->
            </div>
        </div>

        <!-- üéÆ MAIN GAME LAYOUT - side by side -->
        <div id="game-layout">
            <!-- üó∫Ô∏è GAME WORLD - now takes up most of the screen -->
            <main id="game-main">
                <section id="game-world">
                    <!-- World Map Container - EXPANDED -->
                    <div id="map-container" class="map-container">
                        <!-- üñ§ Using HTML-based GameWorldRenderer - canvas removed -->
                        <div id="map-controls" class="map-controls">
                            <button id="zoom-in-btn" title="Zoom in on the map" onclick="if(GameWorldRenderer) GameWorldRenderer.zoomIn()">+</button>
                            <button id="zoom-out-btn" title="Zoom out on the map" onclick="if(GameWorldRenderer) GameWorldRenderer.zoomOut()">-</button>
                            <button id="reset-view-btn" title="Reset map view to default" onclick="if(GameWorldRenderer) GameWorldRenderer.resetView()">‚ü≤</button>
                            <button id="fullscreen-btn" title="Toggle fullscreen map mode" onclick="if(GameWorldRenderer) GameWorldRenderer.toggleFullscreen()">‚õ∂</button>
                            <button id="center-on-player-btn" title="Center map on your current location" onclick="if(GameWorldRenderer) GameWorldRenderer.centerOnPlayer()">üìç</button>
                        </div>
                    </div>

                    <!-- üìç Location Details Panel -->
                    <div id="location-details" class="location-details-panel hidden"></div>
                </section>
            </main>

            <!-- üìä RIGHT SIDE PANEL - Player info, stats, gold, time -->
            <aside id="side-panel">
                <div class="side-panel-section player-section">
                    <div class="player-name-gold-row">
                        <span id="player-name">Player</span>
                        <div class="gold-display">
                            <span class="gold-icon">üí∞</span>
                            <span id="player-gold">100</span>
                        </div>
                    </div>
                    <!-- üñ§ Time moved to top-bar widgets - no longer needed here -->
                </div>

                <div class="side-panel-section stats-section">
                    <div class="section-title">Stats</div>
                    <!-- üñ§ Two-row layout: icons on top, values below -->
                    <div class="stats-two-row">
                        <div class="stats-icons-row">
                            <span class="stat-icon" title="Strength">üí™</span>
                            <span class="stat-icon" title="Intelligence">üß†</span>
                            <span class="stat-icon" title="Charisma">üòä</span>
                            <span class="stat-icon" title="Endurance">üèÉ</span>
                            <span class="stat-icon" title="Luck">üçÄ</span>
                        </div>
                        <div class="stats-values-row">
                            <span class="stat-value" id="player-strength" title="Strength">5</span>
                            <span class="stat-value" id="player-intelligence" title="Intelligence">5</span>
                            <span class="stat-value" id="player-charisma" title="Charisma">5</span>
                            <span class="stat-value" id="player-endurance" title="Endurance">5</span>
                            <span class="stat-value" id="player-luck" title="Luck">5</span>
                        </div>
                    </div>
                </div>

                <div class="side-panel-section vitals-section">
                    <div class="section-title">Vitals</div>
                    <div class="vital-bar">
                        <span class="vital-icon">‚ù§Ô∏è</span>
                        <div class="vital-progress health-bar">
                            <div class="vital-fill" id="health-fill" style="width: 100%"></div>
                        </div>
                        <span class="vital-value" id="player-health-display">100</span>
                    </div>
                    <div class="vital-bar">
                        <span class="vital-icon">üçñ</span>
                        <div class="vital-progress hunger-bar">
                            <div class="vital-fill" id="hunger-fill" style="width: 100%"></div>
                        </div>
                        <span class="vital-value" id="player-hunger-display">100</span>
                    </div>
                    <div class="vital-bar">
                        <span class="vital-icon">üíß</span>
                        <div class="vital-progress thirst-bar">
                            <div class="vital-fill" id="thirst-fill" style="width: 100%"></div>
                        </div>
                        <span class="vital-value" id="player-thirst-display">100</span>
                    </div>
                    <div class="vital-bar">
                        <span class="vital-icon">üò¥</span>
                        <div class="vital-progress energy-bar">
                            <div class="vital-fill" id="energy-fill" style="width: 100%"></div>
                        </div>
                        <span class="vital-value" id="player-energy-display">100</span>
                    </div>
                </div>

                <!-- üñ§ Buttons removed - use bottom action bar or ESC for menu -->
            </aside>

            <!-- UI Panels Container - FLOATING over map -->
            <div id="ui-panels">
                <!-- Game Setup Panel -->
                <section id="game-setup-panel" class="panel hidden">
                    <div class="setup-header">
                        <h2>New Game Setup</h2>
                    </div>
                    <form id="game-setup-form" onsubmit="event.preventDefault(); return false;">
                        <div class="form-group character-name-row">
                            <label for="character-name-input">Character Name:</label>
                            <div class="name-gold-inputs">
                                <input type="text" id="character-name-input" required placeholder="Enter your character name">
                                <div class="setup-gold-display">
                                    <span class="gold-icon">üí∞</span>
                                    <span id="setup-gold-amount" class="gold-value">100</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ‚öîÔ∏è Difficulty Selection - how much do you want to suffer? -->
                        <div class="form-group">
                            <label>Select Difficulty:</label>
                            <div class="difficulty-selection">
                                <div class="difficulty-option" data-difficulty="easy">
                                    <input type="radio" id="difficulty-easy" name="difficulty" value="easy">
                                    <label for="difficulty-easy">
                                        <h3>Easy</h3>
                                        <p>+20% starting gold, better prices, easier progression</p>
                                    </label>
                                </div>
                                <div class="difficulty-option" data-difficulty="normal">
                                    <input type="radio" id="difficulty-normal" name="difficulty" value="normal" checked>
                                    <label for="difficulty-normal">
                                        <h3>Normal</h3>
                                        <p>Standard gameplay experience (100 gold)</p>
                                    </label>
                                </div>
                                <div class="difficulty-option" data-difficulty="hard">
                                    <input type="radio" id="difficulty-hard" name="difficulty" value="hard">
                                    <label for="difficulty-hard">
                                        <h3>Hard</h3>
                                        <p>-20% starting gold, worse prices, harder progression</p>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        
                        <!-- ‚ú® Perk Selection - your character's special traits -->
                        <div class="form-group">
                            <label>Character Perks:</label>
                            <div class="perk-selection-info">
                                <p>Choose unique advantages and disadvantages that shape your character.</p>
                            </div>
                            <button type="button" id="open-perk-modal-btn" class="perk-selection-button" onclick="openPerkModal()">
                                <span class="perk-button-icon">‚ö°</span>
                                <span class="perk-button-text">Select Perks</span>
                                <span class="perk-counter-badge">
                                    <span id="selected-perks-count">0</span>/2
                                </span>
                            </button>
                            <div id="selected-perks-display" class="selected-perks-display">
                                <!-- Selected perks will be shown here -->
                            </div>
                        </div>
                        
                        <!-- üìä Character Attributes - emoji icons with tooltips ü¶á -->
                        <div class="attributes-display">
                            <div class="attributes-header">
                                <span class="attr-header-label">Attributes</span>
                                <div class="attribute-points-remaining" title="Distribute these points among your attributes">
                                    <span class="points-value" id="attr-points-remaining">5</span>
                                    <span class="points-label">pts</span>
                                </div>
                            </div>
                            <div class="attributes-grid">
                                <div class="attribute" title="Strength: Combat damage, carrying capacity, intimidation">
                                    <span class="attribute-icon">üí™</span>
                                    <button type="button" class="attr-btn attr-down" data-attr="strength" title="Decrease Strength">‚àí</button>
                                    <span class="attribute-value" id="attr-strength">5</span>
                                    <button type="button" class="attr-btn attr-up" data-attr="strength" title="Increase Strength">+</button>
                                </div>
                                <div class="attribute" title="Intelligence: Better prices, crafting quality, learning speed">
                                    <span class="attribute-icon">üß†</span>
                                    <button type="button" class="attr-btn attr-down" data-attr="intelligence" title="Decrease Intelligence">‚àí</button>
                                    <span class="attribute-value" id="attr-intelligence">5</span>
                                    <button type="button" class="attr-btn attr-up" data-attr="intelligence" title="Increase Intelligence">+</button>
                                </div>
                                <div class="attribute" title="Charisma: Persuasion, NPC relationships, quest rewards">
                                    <span class="attribute-icon">üí¨</span>
                                    <button type="button" class="attr-btn attr-down" data-attr="charisma" title="Decrease Charisma">‚àí</button>
                                    <span class="attribute-value" id="attr-charisma">5</span>
                                    <button type="button" class="attr-btn attr-up" data-attr="charisma" title="Increase Charisma">+</button>
                                </div>
                                <div class="attribute" title="Endurance: Max health, stamina, resistance to hardship">
                                    <span class="attribute-icon">‚ù§Ô∏è</span>
                                    <button type="button" class="attr-btn attr-down" data-attr="endurance" title="Decrease Endurance">‚àí</button>
                                    <span class="attribute-value" id="attr-endurance">5</span>
                                    <button type="button" class="attr-btn attr-up" data-attr="endurance" title="Increase Endurance">+</button>
                                </div>
                                <div class="attribute" title="Luck: Critical hits, rare loot, random events favor you">
                                    <span class="attribute-icon">üçÄ</span>
                                    <button type="button" class="attr-btn attr-down" data-attr="luck" title="Decrease Luck">‚àí</button>
                                    <span class="attribute-value" id="attr-luck">5</span>
                                    <button type="button" class="attr-btn attr-up" data-attr="luck" title="Increase Luck">+</button>
                                </div>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" id="randomize-character-btn" class="secondary" title="Randomize all character options" onclick="event.preventDefault(); console.log('üìç Randomize clicked'); if(typeof window.randomizeCharacter === 'function') { window.randomizeCharacter(); } else { console.error('‚ùå randomizeCharacter not found'); }">üé≤</button>
                            <button type="button" id="start-game-btn" class="primary" title="Begin your journey into darkness" onclick="event.preventDefault(); console.log('üìç Start Game clicked'); if(typeof window.createCharacter === 'function') { window.createCharacter(event); } else { console.error('‚ùå createCharacter not found'); }">‚ñ∂ Start</button>
                            <button type="button" id="setup-settings-btn" class="secondary" title="Open settings menu" onclick="event.preventDefault(); if(typeof SettingsPanel !== 'undefined' && SettingsPanel.show) { SettingsPanel.show(); } else { console.error('SettingsPanel not available'); }">‚öôÔ∏è</button>
                            <button type="button" id="cancel-setup-btn" class="secondary" title="Return to main menu" onclick="event.preventDefault(); if(typeof cancelGameSetup === 'function') { cancelGameSetup(); } else { document.getElementById('game-setup-panel')?.classList.add('hidden'); document.getElementById('main-menu')?.classList.remove('hidden'); }">‚úñ</button>
                        </div>
                    </form>
                </section>

                <!-- üè™ Market Panel - medieval stock exchange but make it goth -->
                <section id="market-panel" class="panel hidden">
                    <button class="panel-close-x" data-close-overlay="market-panel" title="Close">√ó</button>
                    <div class="market-header">
                        <h2>Market</h2>
                        <div class="market-info">
                            <span id="market-location">Market</span>
                            <span id="market-reputation" class="reputation-display">Reputation: Neutral</span>
                        </div>
                        <div class="market-events" id="market-events">
                            <!-- Market events will be displayed here -->
                        </div>
                    </div>

                    <!-- Merchant Info -->
                    <div id="merchant-info-panel" class="merchant-info-panel">
                        <div class="merchant-greeting">
                            <span id="merchant-greeting-text">"Welcome to my shop!"</span>
                        </div>
                        <div class="merchant-details">
                            <div class="merchant-detail">
                                <span class="merchant-label">Merchant:</span>
                                <span id="merchant-name">Unknown</span>
                            </div>
                            <div class="merchant-detail">
                                <span class="merchant-label">Personality:</span>
                                <span id="merchant-personality">Friendly</span>
                            </div>
                            <div class="merchant-detail">
                                <span class="merchant-label">Relationship:</span>
                                <span id="merchant-relationship">‚ö™ Neutral</span>
                            </div>
                            <div class="merchant-detail">
                                <span class="merchant-label">Specialties:</span>
                                <span id="merchant-specialties">None</span>
                            </div>
                            <div class="merchant-detail merchant-finances">
                                <span class="merchant-label">üí∞ Gold:</span>
                                <span id="merchant-gold" class="merchant-gold">0 gold</span>
                                <span id="merchant-wealth-status" class="merchant-wealth-status">üíµ comfortable</span>
                            </div>
                            <div class="merchant-gold-bar-container">
                                <div id="merchant-gold-bar" class="merchant-gold-bar" style="width: 100%"></div>
                            </div>
                        </div>
                        <!-- üñ§ Talk to Merchant button removed - NPC conversations auto-trigger -->
                    </div>

                    <!-- Trading Controls -->
                    <div class="trading-controls">
                        <div class="trade-mode-toggle">
                            <button id="single-trade-btn" class="trade-mode-btn active" title="Trade items one at a time">Single</button>
                            <button id="bulk-trade-btn" class="trade-mode-btn" title="Trade multiple items at once">Bulk</button>
                        </div>
                        <div class="trade-summary" id="trade-summary">
                            <span id="trade-total">Total: 0 gold</span>
                            <span id="trade-profit">Profit: 0 gold</span>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <button class="tab-btn active" data-tab="buy" title="Buy items from the market">Buy</button>
                        <button class="tab-btn" data-tab="sell" title="Sell your items for gold">Sell</button>
                        <button class="tab-btn" data-tab="compare" title="Compare prices across locations">Compare</button>
                        <button class="tab-btn" data-tab="history" title="View your trade history">History</button>
                        <button class="tab-btn" data-tab="routes" title="Plan profitable trade routes">Routes</button>
                        <button class="tab-btn" data-tab="alerts" title="Set up price alerts">Alerts</button>
                        <button class="tab-btn" data-tab="news" title="Read market news and events">News</button>
                    </div>
                    
                    <div id="market-content">
                        <div id="buy-tab" class="tab-content active">
                            <div class="market-controls">
                                <button id="refresh-market-btn" title="Refresh market prices and inventory">Refresh Market</button>
                                <select id="item-filter" title="Filter items by category">
                                    <option value="all">All Items</option>
                                    <option value="consumables">Consumables</option>
                                    <option value="resources">Resources</option>
                                    <option value="tools">Tools</option>
                                    <option value="luxury">Luxury</option>
                                </select>
                                <div class="bulk-controls hidden" id="bulk-buy-controls">
                                    <button id="select-all-buy-btn" title="Select all available items">Select All</button>
                                    <button id="clear-selection-buy-btn" title="Clear your selection">Clear Selection</button>
                                    <button id="buy-selected-btn" title="Purchase all selected items">Buy Selected</button>
                                </div>
                            </div>
                            <div id="buy-items" class="items-grid">
                                <!-- Items will be populated by JavaScript -->
                            </div>
                            <div id="trade-preview" class="trade-preview hidden">
                                <h4>Trade Preview</h4>
                                <div id="trade-preview-items"></div>
                                <div class="trade-total-info">
                                    <span>Total Cost: <span id="preview-total-cost">0</span> gold</span>
                                    <span>Total Weight: <span id="preview-total-weight">0</span> lbs</span>
                                </div>
                                <div class="trade-actions">
                                    <button id="confirm-trade-btn" title="Complete this trade">Confirm Trade</button>
                                    <button id="cancel-trade-btn" title="Cancel this trade">Cancel</button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="sell-tab" class="tab-content">
                            <div class="market-controls">
                                <span id="sell-info">Sell your items for gold</span>
                                <div class="bulk-controls hidden" id="bulk-sell-controls">
                                    <button id="select-all-sell-btn" title="Select all your items to sell">Select All</button>
                                    <button id="clear-selection-sell-btn" title="Clear your selection">Clear Selection</button>
                                    <button id="sell-selected-btn" title="Sell all selected items">Sell Selected</button>
                                </div>
                            </div>
                            <div id="sell-items" class="items-grid">
                                <!-- Player items will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <div id="compare-tab" class="tab-content">
                            <div class="market-controls">
                                <select id="compare-item-select" title="Choose an item to compare prices">
                                    <option value="">Select an item to compare</option>
                                </select>
                                <button id="update-comparison-btn" title="Update price comparison data">Update Comparison</button>
                                <button id="add-route-btn" title="Add this item to your trade route plan">Add to Route Planner</button>
                            </div>
                            <div id="price-comparison" class="price-comparison">
                                <!-- Price comparison will be displayed here -->
                            </div>
                        </div>
                        
                        <div id="history-tab" class="tab-content">
                            <div class="market-controls">
                                <button id="clear-history-btn" title="Clear all trade history">Clear History</button>
                                <button id="export-history-btn" title="Export trade history data">Export History</button>
                            </div>
                            <div id="trade-history" class="trade-history">
                                <!-- Trade history will be displayed here -->
                            </div>
                        </div>
                        
                        <div id="routes-tab" class="tab-content">
                            <div class="market-controls">
                                <button id="plan-route-btn" title="Plan a new profitable trade route">Plan New Route</button>
                                <button id="clear-routes-btn" title="Clear all saved routes">Clear Routes</button>
                            </div>
                            <div id="route-planner" class="route-planner">
                                <!-- Route planning will be displayed here -->
                            </div>
                        </div>
                        
                        <div id="alerts-tab" class="tab-content">
                            <div class="market-controls">
                                <button id="add-alert-btn" title="Create a new price alert">Add Price Alert</button>
                                <button id="clear-alerts-btn" title="Clear all price alerts">Clear Alerts</button>
                            </div>
                            <div id="price-alerts" class="price-alerts">
                                <!-- Price alerts will be displayed here -->
                            </div>
                        </div>
                        
                        <div id="news-tab" class="tab-content">
                            <div class="market-controls">
                                <button id="refresh-news-btn" title="Refresh market news">Refresh News</button>
                            </div>
                            <div id="market-news" class="market-news">
                                <!-- Market news will be displayed here -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel-footer">
                        <button id="close-market-btn" class="panel-close-btn-footer" data-close-overlay="market-panel" title="Close the market panel">Close</button>
                    </div>
                </section>

                <!-- üéí Inventory Panel - all your worldly possessions -->
                <section id="inventory-panel" class="panel hidden">
                    <button class="panel-close-x" data-close-overlay="inventory-panel" title="Close">√ó</button>
                    <div class="inventory-header">
                        <h2>Inventory</h2>
                        <div class="inventory-controls">
                            <div class="inventory-info">
                                <span id="inventory-weight">Weight: 0/50 lbs</span>
                                <span id="inventory-value">Value: 0 gold</span>
                            </div>
                            <div class="inventory-actions">
                                <button id="sort-inventory-btn" title="Sort inventory items">üî§</button>
                                <button id="filter-inventory-btn" title="Filter inventory items">üîç</button>
                                <button id="inventory-settings-btn" title="Open game settings" onclick="if(typeof SettingsPanel !== 'undefined' && SettingsPanel.show) SettingsPanel.show();">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Access Slots -->
                    <div class="quick-access-container">
                        <h3>Quick Access</h3>
                        <div id="quick-access-slots" class="quick-access-slots">
                            <!-- Quick access slots will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Inventory Filter and Sort Options -->
                    <div id="inventory-options" class="inventory-options hidden">
                        <div class="filter-section">
                            <label for="inventory-category-filter">Category:</label>
                            <select id="inventory-category-filter">
                                <option value="all">All Items</option>
                                <option value="consumables">Consumables</option>
                                <option value="tools">Tools</option>
                                <option value="weapons">Weapons</option>
                                <option value="resources">Resources</option>
                                <option value="luxury">Luxury</option>
                            </select>
                        </div>
                        <div class="sort-section">
                            <label for="inventory-sort-method">Sort By:</label>
                            <select id="inventory-sort-method">
                                <option value="name">Name</option>
                                <option value="value">Value</option>
                                <option value="weight">Weight</option>
                                <option value="quantity">Quantity</option>
                                <option value="category">Category</option>
                                <option value="rarity">Rarity</option>
                            </select>
                            <button id="inventory-sort-order" title="Toggle sort order (ascending/descending)">‚¨áÔ∏è</button>
                        </div>
                    </div>
                    
                    <!-- Inventory Grid -->
                    <div class="inventory-grid-container">
                        <div id="inventory-items" class="inventory-grid">
                            <!-- Inventory items will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Item Details Panel -->
                    <div id="item-details-panel" class="item-details-panel hidden">
                        <div class="item-details-header">
                            <h3 id="detail-item-name">Item Name</h3>
                            <button id="close-item-details" class="close-btn" data-close-overlay="item-details-panel" title="Close">√ó</button>
                        </div>
                        <div class="item-details-content">
                            <div class="item-icon-large" id="detail-item-icon">üì¶</div>
                            <div class="item-info">
                                <p id="detail-item-description">Item description</p>
                                <div class="item-stats">
                                    <div class="item-stat">
                                        <span class="stat-label">Value:</span>
                                        <span id="detail-item-value">0 gold</span>
                                    </div>
                                    <div class="item-stat">
                                        <span class="stat-label">Weight:</span>
                                        <span id="detail-item-weight">0 lbs</span>
                                    </div>
                                    <div class="item-stat">
                                        <span class="stat-label">Quantity:</span>
                                        <span id="detail-item-quantity">0</span>
                                    </div>
                                    <div class="item-stat">
                                        <span class="stat-label">Category:</span>
                                        <span id="detail-item-category">None</span>
                                    </div>
                                    <div class="item-stat">
                                        <span class="stat-label">Rarity:</span>
                                        <span id="detail-item-rarity">Common</span>
                                    </div>
                                </div>
                                <div id="detail-item-effects" class="item-effects hidden">
                                    <h4>Effects:</h4>
                                    <div id="detail-effects-list"></div>
                                </div>
                            </div>
                        </div>
                        <div class="item-details-actions">
                            <button id="use-item-btn" class="action-btn" title="Use this item">Use</button>
                            <button id="equip-item-btn" class="action-btn" title="Equip this item">Equip</button>
                            <button id="drop-item-btn" class="action-btn" title="Drop this item from inventory">Drop</button>
                            <button id="examine-item-btn" class="action-btn" title="Examine this item closely">Examine</button>
                            <button id="gift-item-btn" class="action-btn" title="Gift this item to an NPC">Gift</button>
                        </div>
                    </div>
                    
                    <div class="panel-footer">
                        <button id="close-inventory-btn" class="panel-close-btn-footer" data-close-overlay="inventory-panel" title="Close the inventory panel">Close</button>
                    </div>
                </section>

                <!-- Location Info Panel - MOVED outside ui-panels, positioned via CSS -->

                <!-- üó∫Ô∏è Enhanced Travel Panel - journey into the unknown -->
                <section id="travel-panel" class="panel hidden">
                    <button class="panel-close-x" data-close-overlay="travel-panel" title="Close">√ó</button>
                    <div class="travel-header">
                        <h2>Travel & Exploration</h2>
                        <div class="travel-tabs">
                            <button class="travel-tab-btn" data-travel-tab="destination" title="View your current destination">üéØ Destination</button>
                            <button class="travel-tab-btn active" data-travel-tab="destinations" title="Browse all locations">üìç Locations</button>
                            <button class="travel-tab-btn" data-travel-tab="map" title="View the travel map">üó∫Ô∏è Map</button>
                            <button class="travel-tab-btn" id="open-world-map-overlay-btn" title="Open fullscreen world map">‚õ∂ Full Map</button>
                            <button class="travel-tab-btn" data-travel-tab="history" title="View your travel history">üìú History</button>
                        </div>
                    </div>

                    <div id="travel-content">
                        <!-- Destination Tab (Current Target) -->
                        <div id="destination-tab" class="travel-tab-content">
                            <div id="current-destination-display" class="destination-display">
                                <div class="no-destination">
                                    <span class="no-dest-icon">üéØ</span>
                                    <h3>No Destination Set</h3>
                                    <p>Click on a location in the Locations tab or Map to set a destination.</p>
                                </div>
                            </div>
                            <div id="destination-actions" class="destination-actions hidden">
                                <button id="clear-destination-btn" class="travel-btn-danger" title="Cancel your current destination">‚úï Cancel Destination</button>
                            </div>
                        </div>

                        <!-- Destinations Tab -->
                        <div id="destinations-tab" class="travel-tab-content active">
                            <div class="travel-controls">
                                <div class="travel-filter">
                                    <label for="destination-filter">Filter:</label>
                                    <select id="destination-filter">
                                        <option value="all">All Locations</option>
                                        <option value="visited">üèÜ Visited Only</option>
                                        <option value="connected">Connected Only</option>
                                        <option value="capital">üëë Capitals</option>
                                        <option value="city">üè∞ Cities</option>
                                        <option value="town">üèòÔ∏è Towns</option>
                                        <option value="village">üè† Villages</option>
                                        <option value="mine">‚õèÔ∏è Mines</option>
                                        <option value="forest">üå≤ Forests</option>
                                        <option value="port">‚öì Ports</option>
                                    </select>
                                </div>
                                <div class="travel-sort">
                                    <label for="destination-sort">Sort by:</label>
                                    <select id="destination-sort">
                                        <option value="distance">Distance</option>
                                        <option value="name">Name</option>
                                        <option value="type">Type</option>
                                    </select>
                                </div>
                                <div class="travel-auto-time">
                                    <label class="toggle-switch" title="Auto-start time when traveling, auto-stop on arrival">
                                        <input type="checkbox" id="auto-travel-time-toggle" checked>
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-label">‚è±Ô∏è Auto Time</span>
                                    </label>
                                </div>
                            </div>
                            <div id="destinations" class="destinations-list">
                                <!-- Destinations will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Map Tab with Interactive Mini-Map -->
                        <div id="map-tab" class="travel-tab-content">
                            <!-- Interactive Mini-Map Container -->
                            <div id="travel-mini-map-container" class="travel-mini-map-container">
                                <div id="travel-mini-map" class="travel-mini-map"></div>
                                <div class="mini-map-controls">
                                    <button onclick="TravelPanelMap.zoomIn()" title="Zoom in on the travel map">+</button>
                                    <button onclick="TravelPanelMap.zoomOut()" title="Zoom out on the travel map">‚àí</button>
                                    <button onclick="TravelPanelMap.centerOnPlayer()" title="Center map on your location">üìç</button>
                                    <button onclick="TravelPanelMap.resetView()" title="Reset travel map view">‚ü≤</button>
                                </div>
                            </div>
                            <!-- Map Legend (matches main world map) -->
                            <div class="travel-map-legend">
                                <h4>üó∫Ô∏è Map Legend</h4>
                                <div class="legend-grid">
                                    <div class="legend-item"><span class="legend-dot" style="background: #FFD700;"></span><span>üëë Capital</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #FF6B6B;"></span><span>üè∞ City</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #4ECDC4;"></span><span>üèòÔ∏è Town</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #95E77E;"></span><span>üè† Village</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #8B4513;"></span><span>‚õèÔ∏è Mine</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #228B22;"></span><span>üå≤ Forest</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #F4A460;"></span><span>üåæ Farm</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #1E90FF;"></span><span>‚öì Port</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #DAA520;"></span><span>üç∫ Inn</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #708090;"></span><span>üèõÔ∏è Ruins</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #4B0082;"></span><span>üíÄ Dungeon</span></div>
                                    <div class="legend-item"><span class="legend-dot" style="background: #CD853F;"></span><span>üõ°Ô∏è Outpost</span></div>
                                </div>
                                <div class="legend-info">
                                    <p>üìç <strong>You are here</strong> (pulsing marker)</p>
                                    <p>üéØ <strong>Destination</strong> (if set)</p>
                                    <p>Click a location to set as destination</p>
                                </div>
                            </div>
                        </div>

                        <!-- History Tab -->
                        <div id="history-tab" class="travel-tab-content">
                            <div class="history-controls">
                                <button id="clear-history-btn" title="Clear all travel history">üóëÔ∏è Clear History</button>
                                <button id="export-history-btn" title="Export travel history data">üì§ Export</button>
                            </div>
                            <div id="travel-history" class="travel-history-list">
                                <!-- Travel history will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <div class="panel-footer">
                        <button id="close-travel-btn" class="panel-close-btn-footer" data-close-overlay="travel-panel" title="Close the travel panel">Close</button>
                    </div>
                </section>

                <!-- üê¥ Transportation Panel - upgrade from walking sadly -->
                <section id="transportation-panel" class="panel hidden">
                    <button class="panel-close-x" data-close-overlay="transportation-panel" title="Close">√ó</button>
                    <h2>Transportation</h2>
                    <div class="transportation-info">
                        <p>Current Transport: <span id="current-transport">Backpack</span></p>
                        <p>Carry Capacity: <span id="carry-capacity">50 lbs</span></p>
                        <p>Current Load: <span id="current-load">0 lbs</span></p>
                    </div>
                    <h3>Available Transportation</h3>
                    <div id="transportation-options" class="items-grid">
                        <!-- Transportation options will be populated by JavaScript -->
                    </div>
                    <div class="panel-footer">
                        <button id="close-transportation-btn" class="panel-close-btn-footer" data-close-overlay="transportation-panel" title="Close the transportation panel">Close</button>
                    </div>
                </section>

                <!-- üè∞ Property & Employee Management - your medieval empire -->
                <section id="property-employee-panel" class="panel hidden">
                    <button class="panel-close-x" data-close-overlay="property-employee-panel" title="Close">√ó</button>
                    <div class="property-employee-header">
                        <h2>Property & Employee Management</h2>
                        <div class="financial-summary">
                            <span id="property-income">Property Income: 0 gold/day</span>
                            <span id="employee-costs">Employee Costs: 0 gold/week</span>
                            <span id="net-profit">Net Profit: 0 gold/day</span>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <button class="tab-btn active" data-tab="properties" title="Manage your properties">Properties</button>
                        <button class="tab-btn" data-tab="employees" title="Manage your employees">Employees</button>
                        <button class="tab-btn" data-tab="trade-routes" title="View and manage trade routes">Trade Routes</button>
                        <button class="tab-btn" data-tab="financial" title="View financial information">Financial</button>
                    </div>
                    
                    <div id="property-employee-content">
                        <!-- Properties Tab -->
                        <div id="properties-tab" class="tab-content active">
                            <div class="properties-controls">
                                <button id="buy-property-btn" title="Purchase a new property">Buy Property</button>
                                <button id="property-upgrades-btn" title="Manage property upgrades">Manage Upgrades</button>
                                <button id="repair-all-btn" title="Repair all damaged properties">Repair All</button>
                            </div>
                            <div id="owned-properties" class="properties-grid">
                                <!-- Owned properties will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Employees Tab -->
                        <div id="employees-tab" class="tab-content">
                            <div class="employees-controls">
                                <button id="hire-employee-btn" title="Hire a new employee">Hire Employee</button>
                                <button id="employee-training-btn" title="Train your employees">Training</button>
                                <button id="pay-wages-btn" title="Pay employee wages">Pay Wages</button>
                            </div>
                            <div id="hired-employees" class="employees-grid">
                                <!-- Hired employees will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Trade Routes Tab -->
                        <div id="trade-routes-tab" class="tab-content">
                            <div class="trade-routes-controls">
                                <button id="create-route-btn" title="Create a new trade route">Create Route</button>
                                <button id="optimize-routes-btn" title="Optimize existing trade routes">Optimize Routes</button>
                                <button id="route-history-btn" title="View route history">Route History</button>
                            </div>
                            <div id="active-routes" class="routes-grid">
                                <!-- Active trade routes will be populated by JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Financial Tab -->
                        <div id="financial-tab" class="tab-content">
                            <div class="financial-overview">
                                <h3>Financial Overview</h3>
                                <div class="financial-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Daily Income:</span>
                                        <span id="daily-income" class="stat-value">0 gold</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Weekly Expenses:</span>
                                        <span id="weekly-expenses" class="stat-value">0 gold</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Property Value:</span>
                                        <span id="property-value" class="stat-value">0 gold</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Total Assets:</span>
                                        <span id="total-assets" class="stat-value">0 gold</span>
                                    </div>
                                </div>
                            </div>
                            <div class="financial-history">
                                <h3>Transaction History</h3>
                                <div id="transaction-history" class="transaction-list">
                                    <!-- Transaction history will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel-footer">
                        <button id="close-property-employee-btn" class="panel-close-btn-footer" data-close-overlay="property-employee-panel" title="Close the property panel">Close</button>
                    </div>
                </section>

                <!-- Property Details Modal -->
                <div id="property-details-modal" class="modal hidden">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="property-details-name">Property Name</h3>
                            <button id="close-property-details" class="close-btn" data-close-overlay="property-details-modal" title="Close">√ó</button>
                        </div>
                        <div class="modal-body">
                            <div class="property-info">
                                <div class="property-icon" id="property-details-icon">üè†</div>
                                <div class="property-stats">
                                    <div class="property-stat">
                                        <span class="stat-label">Type:</span>
                                        <span id="property-details-type">House</span>
                                    </div>
                                    <div class="property-stat">
                                        <span class="stat-label">Location:</span>
                                        <span id="property-details-location">Town</span>
                                    </div>
                                    <div class="property-stat">
                                        <span class="stat-label">Level:</span>
                                        <span id="property-details-level">1</span>
                                    </div>
                                    <div class="property-stat">
                                        <span class="stat-label">Condition:</span>
                                        <span id="property-details-condition">100%</span>
                                    </div>
                                    <div class="property-stat">
                                        <span class="stat-label">Income:</span>
                                        <span id="property-details-income">10 gold/day</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="property-upgrades">
                                <h4>Available Upgrades</h4>
                                <div id="property-upgrades-list" class="upgrades-list">
                                    <!-- Upgrades will be populated by JavaScript -->
                                </div>
                            </div>
                            
                            <div class="property-employees">
                                <h4>Assigned Employees</h4>
                                <div id="property-employees-list" class="employees-list">
                                    <!-- Assigned employees will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button id="repair-property-btn" class="action-btn" title="Repair this property">Repair</button>
                            <button id="upgrade-property-btn" class="action-btn" title="Upgrade this property">Upgrade</button>
                            <button id="sell-property-btn" class="action-btn danger" title="Sell this property">Sell</button>
                        </div>
                    </div>
                </div>

                <!-- Employee Details Modal -->
                <div id="employee-details-modal" class="modal hidden">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="employee-details-name">Employee Name</h3>
                            <button id="close-employee-details" class="close-btn" data-close-overlay="employee-details-modal" title="Close">√ó</button>
                        </div>
                        <div class="modal-body">
                            <div class="employee-info">
                                <div class="employee-avatar" id="employee-details-avatar">üë§</div>
                                <div class="employee-stats">
                                    <div class="employee-stat">
                                        <span class="stat-label">Type:</span>
                                        <span id="employee-details-type">Merchant</span>
                                    </div>
                                    <div class="employee-stat">
                                        <span class="stat-label">Level:</span>
                                        <span id="employee-details-level">1</span>
                                    </div>
                                    <div class="employee-stat">
                                        <span class="stat-label">Experience:</span>
                                        <span id="employee-details-experience">0/100</span>
                                    </div>
                                    <div class="employee-stat">
                                        <span class="stat-label">Morale:</span>
                                        <span id="employee-details-morale">Normal</span>
                                    </div>
                                    <div class="employee-stat">
                                        <span class="stat-label">Wage:</span>
                                        <span id="employee-details-wage">5 gold/week</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="employee-skills">
                                <h4>Skills</h4>
                                <div id="employee-skills-list" class="skills-list">
                                    <!-- Skills will be populated by JavaScript -->
                                </div>
                            </div>
                            
                            <div class="employee-assignment">
                                <h4>Current Assignment</h4>
                                <div id="employee-assignment-info" class="assignment-info">
                                    <!-- Assignment info will be populated by JavaScript -->
                                </div>
                                <div class="assignment-controls">
                                    <select id="assignment-property-select" title="Choose a property to assign">
                                        <option value="">Select Property</option>
                                    </select>
                                    <button id="assign-employee-btn" title="Assign employee to selected property">Assign</button>
                                    <button id="unassign-employee-btn" title="Unassign employee from current property">Unassign</button>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button id="train-employee-btn" class="action-btn" title="Train this employee">Train</button>
                            <button id="promote-employee-btn" class="action-btn" title="Promote this employee">Promote</button>
                            <button id="fire-employee-btn" class="action-btn danger" title="Fire this employee">Fire</button>
                        </div>
                    </div>
                </div>

                <!-- Message Log - MOVED outside ui-panels, positioned via CSS -->
            </div>
        </div>

        <!-- üñ§ Location Panel - FIXED bottom-left, outside ui-panels -->
        <section id="location-panel" class="panel">
            <h2 id="location-name">Town Square</h2>
            <p id="location-description">You are in the town square.</p>
            <div id="location-actions">
                <button id="visit-market-btn" title="Visit the local market">Visit Market</button>
                <button id="travel-btn" title="Open travel menu">Travel</button>
                <button id="transportation-btn" title="View transportation options">Transportation</button>
            </div>
        </section>

        <!-- üìú Message Log - FIXED bottom-right, outside ui-panels -->
        <section id="message-log">
            <h3>Messages</h3>
            <div id="messages">
                <p class="message" id="welcome-message">Welcome to Medieval Trading Game!</p>
            </div>
        </section>

        <!-- üéÆ Bottom Action Bar - compact row of action buttons -->
        <footer id="bottom-action-bar">
            <button id="bottom-menu-btn" class="action-btn-bottom menu-btn-highlight" title="Menu [ESC]" onclick="KeyBindings.openMenu();">üìã</button>
            <button id="bottom-market-btn" class="action-btn-bottom" title="Visit Market [M]" onclick="KeyBindings.openMarket();">üè™</button>
            <button id="bottom-travel-btn" class="action-btn-bottom" title="Travel [T]" onclick="KeyBindings.openTravel();">üó∫Ô∏è</button>
            <button id="bottom-transport-btn" class="action-btn-bottom" title="Transport [W]" onclick="KeyBindings.openTransportation();">üöó</button>
            <button id="bottom-inventory-btn" class="action-btn-bottom" title="Inventory [I]" onclick="KeyBindings.openInventory();">üéí</button>
            <button id="bottom-character-btn" class="action-btn-bottom" title="Character [C]" onclick="KeyBindings.openCharacterSheet();">üë§</button>
            <button id="bottom-people-btn" class="action-btn-bottom" title="People [O]" onclick="KeyBindings.openPeople();">üë•</button>
            <button id="bottom-financial-btn" class="action-btn-bottom" title="Finances [F]" onclick="KeyBindings.openFinancialSheet();">üí∞</button>
            <button id="bottom-quests-btn" class="action-btn-bottom" title="Quest Log [Q]" onclick="KeyBindings.openQuests();">üìú</button>
            <button id="bottom-achievements-btn" class="action-btn-bottom" title="Achievements [A]" onclick="KeyBindings.openAchievements();">üèÜ</button>
            <button id="bottom-save-btn" class="action-btn-bottom" title="Save Game [F5]" onclick="KeyBindings.openSave();">üíæ</button>
            <button id="bottom-load-btn" class="action-btn-bottom" title="Load Game [F9]" onclick="KeyBindings.openLoad();">üìÇ</button>
            <button id="bottom-settings-btn" class="action-btn-bottom" title="Settings [,]" onclick="KeyBindings.openSettings();">‚öôÔ∏è</button>
        </footer>
    </div>

    <!-- ‚è≥ Loading Screen - please wait while we summon the medieval times -->
    <div id="loading-screen" class="screen">
        <div class="loading-content">
            <h1 style="color: #4fc3f7; margin-bottom: 0.5rem;">Medieval Trading Game</h1>
            <h2 id="loading-title" style="color: #888; font-weight: normal;">Awakening the void...</h2>
            <div class="progress-bar" style="width: 300px; height: 20px; background: #222; border-radius: 10px; overflow: hidden; margin: 1rem auto;">
                <div id="loading-progress-fill" class="progress-fill" style="width: 0%; height: 100%; background: linear-gradient(90deg, #4fc3f7, #29b6f6); transition: width 0.5s ease-out;"></div>
            </div>
            <p id="loading-status" style="color: #666; font-size: 0.9rem;">Initializing...</p>
        </div>
    </div>

    <!-- üè† Main Menu - where it all begins (again) -->
    <div id="main-menu" class="screen hidden">
        <!-- üå¶Ô∏è Weather Effects Container - random seasonal magic -->
        <div id="menu-weather-container" class="menu-weather-container"></div>
        <div class="menu-content">
            <h1 id="main-menu-title">Medieval Trading Game</h1>
            <p id="main-menu-version" class="version-text"></p>
            <div class="menu-buttons">
                <button id="new-game-btn" onclick="if(typeof startNewGame==='function'){startNewGame();}else if(window.startNewGame){window.startNewGame();}else{console.error('startNewGame not found');}" title="Start a new game">New Game</button>
                <button id="load-game-btn" onclick="if(typeof loadGame === 'function') loadGame();" disabled title="Load a saved game">Load Game</button>
                <button id="settings-btn" onclick="if(typeof SettingsPanel !== 'undefined' && SettingsPanel.show) SettingsPanel.show(); else console.error('SettingsPanel not loaded');" title="Open game settings">Settings</button>
            </div>

            <!-- üèÜ Hall of Champions is created dynamically by save-ui-system.js -->
            <!-- It includes the "View All Champions" button -->

            <!-- üîó Social Links - escape routes -->
            <div id="menu-social-links" class="menu-social-links">
                <!-- Will be populated by JavaScript from GameConfig -->
            </div>

            <div class="menu-footer">
                <span id="menu-copyright"></span>
            </div>
        </div>
    </div>

    <!-- üèÜ Leaderboard Panel - Hall of Champions overlay (MUST be outside overlay-container for z-index to work above main-menu) -->
    <div id="leaderboard-overlay" class="leaderboard-overlay hidden" onclick="if(event.target === this) { if(typeof SaveUISystem !== 'undefined') SaveUISystem.closeHallOfChampions(); else closeLeaderboardPanel(); }">
        <div class="leaderboard-panel" onclick="event.stopPropagation()">
            <button class="panel-close-x" onclick="if(typeof SaveUISystem !== 'undefined') SaveUISystem.closeHallOfChampions(); else closeLeaderboardPanel(); event.stopPropagation();" title="Close">√ó</button>
            <div class="leaderboard-panel-header">
                <h2>üèÜ Hall of Champions</h2>
                <p class="leaderboard-subtitle">top 100 merchants of all time</p>
            </div>
            <div id="leaderboard-panel-content" class="leaderboard-panel-content">
                <!-- Populated by JavaScript -->
            </div>
            <div class="panel-footer">
                <button class="panel-close-btn-footer" onclick="if(typeof SaveUISystem !== 'undefined') SaveUISystem.closeHallOfChampions(); else closeLeaderboardPanel();" title="Close the Hall of Champions">Close</button>
            </div>
        </div>
    </div>

    <!-- üêõ DEBOOGER CONSOLE - ON-SCREEN CONSOLE LOG (z-index above main menu) -->
    <div id="debooger-console" style="position: fixed; bottom: 0; right: 0; width: 600px; height: 80vh; max-height: 800px; background: rgba(0,0,0,0.95); color: #0f0; font-family: monospace; font-size: 11px; z-index: 999998; border: 2px solid #0f0; display: none; flex-direction: column;">
        <!-- Header -->
        <div style="display: flex; justify-content: space-between; padding: 8px 10px; border-bottom: 1px solid #0f0; background: rgba(0,0,0,0.98); flex-shrink: 0;">
            <strong style="color: #0ff;">üêõ DEBOOGER CONSOLE</strong>
            <button onclick="document.getElementById('debooger-console').style.display='none'" style="background: #f00; color: #fff; border: none; padding: 2px 8px; cursor: pointer;" title="Close the debugger console">Close</button>
        </div>
        <!-- Scrollable Log Content -->
        <div id="debooger-console-content" style="flex: 1; overflow-y: auto; padding: 10px; font-size: 10px; line-height: 1.4;"></div>
        <!-- Command Input (Fixed at Bottom) -->
        <div id="debooger-command-container" style="display: flex; gap: 8px; align-items: center; padding: 8px 10px; border-top: 2px solid #0f0; background: rgba(0,20,0,0.98); flex-shrink: 0;">
            <span style="color: #0ff; font-weight: bold; font-size: 14px;">></span>
            <input type="text"
                   id="debooger-command-input"
                   placeholder="Type command... (Enter to run, Tab to autocomplete)"
                   style="flex: 1; background: rgba(0,40,0,0.8); border: 1px solid #0f0; color: #0f0; font-family: monospace; font-size: 12px; padding: 8px 10px; outline: none; border-radius: 4px;"
                   autocomplete="off"
                   spellcheck="false"
            />
            <button id="debooger-command-execute" style="background: #0a0; border: 1px solid #0f0; color: #fff; padding: 8px 12px; cursor: pointer; font-family: monospace; font-size: 12px; border-radius: 4px;" title="Execute the command">Run</button>
            <button id="debooger-command-help" style="background: #005; border: 1px solid #0ff; color: #0ff; padding: 8px 12px; cursor: pointer; font-family: monospace; font-size: 12px; border-radius: 4px;" title="Show available commands">?</button>
        </div>
    </div>
    <button id="toggle-debooger-console" onclick="var dc=document.getElementById('debooger-console');if(dc){dc.style.display=(dc.style.display==='none'||dc.style.display==='')?'flex':'none';}" style="position: fixed; bottom: 10px; right: 10px; z-index: 999999; background: #000; color: #0f0; border: 2px solid #0f0; padding: 10px; cursor: pointer; font-family: monospace;" title="Toggle developer debugger console">
        üêõ Debooger
    </button>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         üñ§ LOADING MANAGER - tracks progress and shows loading bar
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <script src="src/js/init/loading-manager.js?v=0.88"></script>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         ‚ö°‚ö°‚ö° CRITICAL: CORE DEPENDENCIES - MUST LOAD FIRST ‚ö°‚ö°‚ö°
         EventManager and TimerManager are used by ALL other systems
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <script src="src/js/core/event-manager.js?v=0.88"></script>
    <script src="src/js/core/timer-manager.js?v=0.88"></script>

    <!-- üñ§ NEW: Core utilities from refactor -->
    <script src="src/js/core/system-registry.js?v=0.88"></script>
    <script src="src/js/core/event-bus.js?v=0.88"></script>
    <script src="src/js/utils/color-utils.js?v=0.88"></script>
    <script src="src/js/utils/virtual-list.js?v=0.88"></script>
    <!-- ‚è∞ THE TIME MACHINE - Unified time engine (replaces time-system.js + game-engine.js) -->
    <script src="src/js/core/time-machine.js?v=0.88"></script>
    <script src="src/js/data/game-world.js?v=0.88"></script>

    <!-- üõ†Ô∏è Browser Utilities (depend on EventManager) -->
    <script src="src/js/init/browser-compatibility.js?v=0.88"></script>
    <script src="src/js/ui/components/modal-system.js?v=0.88"></script>

    <!-- üìä Data Systems (depend on EventManager + TimerManager) -->
    <script src="src/js/data/items/item-database.js?v=0.88"></script>
    <script src="src/js/data/items/unified-item-system.js?v=0.88"></script>
    <script src="src/js/systems/crafting/crafting-economy-system.js?v=0.88"></script>

    <!-- üî® NEW: Crafting Engine (implements actual crafting logic) -->
    <script src="src/js/systems/crafting/crafting-engine.js?v=0.88"></script>

    <!-- ‚öîÔ∏è NEW: Combat System (full combat resolution) -->
    <script src="src/js/systems/combat/combat-system.js?v=0.88"></script>
    <script src="src/js/systems/trading/market-price-history.js?v=0.88"></script>
    <script src="src/js/systems/trading/dynamic-market-system.js?v=0.88"></script>

    <!-- üèõÔ∏è City Systems -->
    <script src="src/js/systems/world/city-reputation-system.js?v=0.88"></script>
    <script src="src/js/systems/world/city-event-system.js?v=0.88"></script>
    <script src="src/js/systems/world/dungeon-bonanza-system.js?v=0.88"></script>

    <!-- üíº Business Systems -->
    <script src="src/js/systems/trading/trading-system.js?v=0.88"></script>
    <script src="src/js/ui/panels/inventory-panel.js?v=0.88"></script>

    <!-- üë§ NPC System - consolidated into npc/ folder üñ§ -->
    <script src="src/js/npc/npc-manager.js?v=0.88"></script>
    <script src="src/js/npc/npc-merchants.js?v=0.88"></script>
    <script src="src/js/npc/npc-dialogue.js?v=0.88"></script>
    <script src="src/js/npc/npc-workflow.js?v=0.88"></script>
    <script src="src/js/npc/npc-voice.js?v=0.88"></script>
    <script src="src/js/npc/npc-chat-ui.js?v=0.88"></script>
    <script src="src/js/npc/npc-encounters.js?v=0.88"></script>
    <script src="src/js/systems/story/initial-encounter.js?v=0.88"></script>
    <script src="src/js/npc/npc-relationships.js?v=0.88"></script>
    <script src="src/js/npc/npc-trade.js?v=0.88"></script>
    <script src="src/js/ui/panels/trade-cart-panel.js?v=0.88"></script>

    <!-- ü§ñ Command & Quest Systems (v0.7) -->
    <script src="src/js/debooger/api-command-system.js?v=0.88"></script>
    <script src="src/js/systems/progression/quest-system.js?v=0.88"></script>

    <!-- üëë Merchant Rank System - defines property/employee limits -->
    <script src="src/js/systems/trading/merchant-rank-system.js?v=0.88"></script>

    <!-- ‚öîÔ∏è Equipment System - gear up for adventure -->
    <script src="src/js/ui/panels/equipment-panel.js?v=0.88"></script>

    <!-- üèóÔ∏è Property System - modular architecture üñ§ -->
    <script src="src/js/property/property-types.js?v=0.88"></script>
    <script src="src/js/property/property-storage.js?v=0.88"></script>
    <script src="src/js/property/property-purchase.js?v=0.88"></script>
    <script src="src/js/property/property-income.js?v=0.88"></script>
    <script src="src/js/property/property-upgrades.js?v=0.88"></script>
    <script src="src/js/property/property-ui.js?v=0.88"></script>
    <script src="src/js/property/property-system-facade.js?v=0.88"></script>
    <!-- üë• Employee Systems -->
    <script src="src/js/systems/employee/employee-system.js?v=0.88"></script>
    <script src="src/js/systems/employee/property-employee-bridge.js?v=0.88"></script>
    <script src="src/js/systems/employee/property-employee-ui.js?v=0.88"></script>

    <!-- üó∫Ô∏è Travel & Routes -->
    <script src="src/js/systems/travel/travel-system.js?v=0.88"></script>
    <script src="src/js/systems/trading/trade-route-system.js?v=0.88"></script>

    <!-- üè∞ Gatehouse & Resource Gathering Systems -->
    <script src="src/js/systems/travel/gatehouse-system.js?v=0.88"></script>
    <script src="src/js/systems/crafting/resource-gathering-system.js?v=0.88"></script>
    <script src="src/js/systems/combat/dungeon-exploration-system.js?v=0.88"></script>

    <!-- üñ§ Game World Renderer - where the map magic happens -->
    <!-- üó∫Ô∏è Map rendering - base class + implementations -->
    <script src="src/js/ui/map/map-renderer-base.js?v=0.88"></script>
    <script src="src/js/ui/map/game-world-renderer.js?v=0.88"></script>
    <script src="src/js/systems/travel/travel-panel-map.js?v=0.88"></script>

    <!-- üéØ Achievement System -->
    <script src="src/js/systems/progression/achievement-system.js?v=0.88"></script>

    <!-- üèÜ Global Leaderboard System -->
    <script src="src/js/ui/panels/leaderboard-panel.js?v=0.88"></script>

    <!-- üíÄ Death Cause System - tracks how your journey ends -->
    <script src="src/js/systems/combat/death-cause-system.js?v=0.88"></script>

    <!-- üíÄ Game Over System -->
    <script src="src/js/systems/combat/game-over-system.js?v=0.88"></script>

    <!-- üé® UI & Polish Systems -->
    <script src="src/js/ui/ui-enhancements.js?v=0.88"></script>
    <script src="src/js/ui/ui-polish-system.js?v=0.88"></script>
    <script src="src/js/ui/button-fix.js?v=0.88"></script>
    <script src="src/js/ui/panels/settings-panel.js?v=0.88"></script>
    <script src="src/js/ui/panels/people-panel.js?v=0.88"></script>
    <script src="src/js/ui/components/tooltip-system.js?v=0.88"></script>
    <script src="src/js/ui/components/draggable-panels.js?v=0.88"></script>
    <script src="src/js/ui/components/panel-manager.js?v=0.88"></script>

    <!-- üíæ UNIFIED Save/Load System üñ§ -->
    <script src="src/js/systems/save/save-manager.js?v=0.88"></script>

    <!-- üå¶Ô∏è NEW: Weather & Day/Night Systems -->
    <script src="src/js/systems/world/weather-system.js?v=0.88"></script>
    <script src="src/js/systems/world/day-night-cycle.js?v=0.88"></script>

    <!-- üèõÔ∏è NEW: Faction System -->
    <script src="src/js/systems/progression/faction-system.js?v=0.88"></script>

    <!-- üéì NEW: Skill System (full skill tree UI) -->
    <script src="src/js/systems/progression/skill-system.js?v=0.88"></script>

    <!-- üèÜ NEW: Reputation Consequences (reputation now affects gameplay) -->
    <script src="src/js/systems/progression/reputation-system.js?v=0.88"></script>

    <!-- üìÖ NEW: NPC Schedule System (NPCs follow daily routines) -->
    <script src="src/js/systems/npc/npc-schedule-system.js?v=0.88"></script>

    <!-- üê¥ NEW: Mount System (mounts for travel and cargo) -->
    <script src="src/js/systems/travel/mount-system.js?v=0.88"></script>

    <!-- ‚õµ NEW: Ship Trading System (sea routes and maritime trade) -->
    <script src="src/js/systems/travel/ship-system.js?v=0.88"></script>

    <!-- üé¨ Immersive Experience Systems -->
    <script src="src/js/effects/visual-effects-system.js?v=0.88"></script>
    <script src="src/js/audio/audio-system.js?v=0.88"></script>
    <script src="src/js/effects/animation-system.js?v=0.88"></script>
    <script src="src/js/effects/environmental-effects-system.js?v=0.88"></script>
    <script src="src/js/effects/immersive-experience-integration.js?v=0.88"></script>
    <script src="src/js/effects/menu-weather-system.js?v=0.88"></script>

    <!-- ‚ö° Performance Optimizer -->
    <script src="src/js/debooger/performance-optimizer.js?v=0.88"></script>

    <!-- üêõ Debooger System - ON by default for Super Hacker achievement üñ§ -->
    <script src="src/js/core/debooger-system.js?v=0.88"></script>

    <!-- üéØ Current Task System - tracks player activity üíÄ -->
    <script src="src/js/systems/current-task-system.js?v=0.88"></script>

    <!-- ‚å®Ô∏è Key Bindings - your keyboard is your weapon ü¶á -->
    <script src="src/js/ui/key-bindings.js?v=0.88"></script>

    <!-- üéÆ CORE GAME - Must load LAST (depends on all systems above) -->
    <script src="src/js/core/game.js?v=0.88"></script>

    <!-- üéÆ GAME ENGINE - NOW HANDLED BY TIME MACHINE (time-machine.js loaded earlier) -->

    <!-- üéÆ DEBOOGER COMMAND SYSTEM - Cheat codes and developer tools -->
    <script src="src/js/debooger/debooger-command-system.js?v=0.88"></script>

    <!-- üñ§ BOOTSTRAP - Coordinates initialization of all systems (loads last) -->
    <script src="src/js/init/bootstrap.js?v=0.88"></script>

    <script>
        // Initialize the property-employee bridge after all systems are loaded
        if (typeof PropertyEmployeeBridge !== 'undefined') {
            PropertyEmployeeBridge.init();
        }

        // Apply GameConfig values to UI elements
        if (typeof GameConfig !== 'undefined') {
            // Update document title
            document.title = GameConfig.game.name;

            // Update main menu title and version
            const mainMenuTitle = document.getElementById('main-menu-title');
            if (mainMenuTitle) mainMenuTitle.textContent = GameConfig.game.name;

            const versionText = document.getElementById('main-menu-version');
            if (versionText) versionText.textContent = GameConfig.getVersionString();

            // Update top bar title
            const topBarTitle = document.getElementById('top-bar-title');
            if (topBarTitle) topBarTitle.textContent = GameConfig.ui.topBarTitle;

            // Update loading title
            const loadingTitle = document.getElementById('loading-title');
            if (loadingTitle) loadingTitle.textContent = GameConfig.ui.loadingMessage;

            // Update welcome message
            const welcomeMsg = document.getElementById('welcome-message');
            if (welcomeMsg) welcomeMsg.textContent = GameConfig.ui.welcomeMessage;

            // Update copyright
            const menuCopyright = document.getElementById('menu-copyright');
            if (menuCopyright) menuCopyright.textContent = GameConfig.credits.copyright;

            // Populate social links
            const socialLinksContainer = document.getElementById('menu-social-links');
            if (socialLinksContainer && GameConfig.links) {
                const links = GameConfig.links;
                let linksHTML = '';

                if (links.website) {
                    linksHTML += `<a href="${links.website}" target="_blank" class="menu-social-link" title="Website"><span class="link-icon">üåê</span></a>`;
                }
                if (links.github) {
                    linksHTML += `<a href="${links.github}" target="_blank" class="menu-social-link" title="GitHub"><span class="link-icon">üíª</span></a>`;
                }
                if (links.discord) {
                    linksHTML += `<a href="${links.discord}" target="_blank" class="menu-social-link" title="Discord"><span class="link-icon">üí¨</span></a>`;
                }
                if (links.support) {
                    linksHTML += `<a href="mailto:${links.support}" class="menu-social-link" title="Contact Us"><span class="link-icon">‚úâÔ∏è</span></a>`;
                }

                socialLinksContainer.innerHTML = linksHTML;

                // Hide if no links
                if (!linksHTML) {
                    socialLinksContainer.style.display = 'none';
                }
            }

            console.log(`üéÆ ${GameConfig.game.name} v${GameConfig.version.game} initialized`);
            console.log(`üè¢ Unity AI Lab by Hackall360 Sponge GFourteen www.unityailab.com`);
        }
    </script>

    <!-- üêõ DEBOOGER TOGGLE - Global helper function -->
    <script>
        // üêõ Global toggle function (backup - inline onclick is primary)
        window.toggleDebooger = function() {
            var dc = document.getElementById('debooger-console');
            if (dc) {
                dc.style.display = (dc.style.display === 'none' || dc.style.display === '') ? 'flex' : 'none';
            }
        };
        console.log('üêõ Debooger toggle ready');
    </script>
</body>
</html>
